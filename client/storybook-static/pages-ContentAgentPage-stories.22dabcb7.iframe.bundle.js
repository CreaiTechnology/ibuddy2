"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[241],{"./src/api/axiosInstance.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var axios__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/axios/lib/axios.js");const API_BASE_URL=__webpack_require__("./node_modules/process/browser.js").env.REACT_APP_API_BASE_URL||"http://localhost:3001/api",axiosInstance=axios__WEBPACK_IMPORTED_MODULE_0__.A.create({baseURL:API_BASE_URL,timeout:1e4,headers:{"Content-Type":"application/json"}});axiosInstance.interceptors.request.use((config=>{const token=localStorage.getItem("auth_token");return console.log("Axios Interceptor - Reading token using key 'auth_token':",token?"Found":"Not Found"),token?(config.headers.Authorization=`Bearer ${token}`,console.log("Axios Interceptor - Setting Authorization header.")):console.log("Axios Interceptor - 'auth_token' not found in localStorage."),config}),(error=>Promise.reject(error))),axiosInstance.interceptors.response.use((response=>response),(error=>(error.response&&401===error.response.status&&console.error("Unauthorized access - 401"),Promise.reject(error))));const __WEBPACK_DEFAULT_EXPORT__=axiosInstance},"./src/context/AuthContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{cy:()=>AuthContext,As:()=>useAuth});var react=__webpack_require__("../node_modules/react/index.js"),dist_module=__webpack_require__("./node_modules/@supabase/supabase-js/dist/module/index.js");const supabaseUrl="https://mgheimlvdvazclsutmzf.supabase.co",supabaseAnonKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1naGVpbWx2ZHZhemNsc3V0bXpmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM1OTM1MDAsImV4cCI6MjA1OTE2OTUwMH0.QfcKOfYqVqRB1UshudDO5VmsV7qx3bT0tPItLrY9Vno";console.warn("Supabase URL or Anon Key is not configured. Please create a .env file in the client directory with REACT_APP_SUPABASE_URL and REACT_APP_SUPABASE_ANON_KEY.");(0,dist_module.UU)(supabaseUrl,supabaseAnonKey);__webpack_require__("./node_modules/react-router/dist/development/chunk-AYJ5UCUI.mjs"),__webpack_require__("../node_modules/react/jsx-runtime.js");const AuthContext=(0,react.createContext)(),useAuth=()=>(0,react.useContext)(AuthContext)},"./src/hooks/useFeatureGuard.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B:()=>useFeatureGuard});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/react/index.js"),react_router_dom__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-router/dist/development/chunk-AYJ5UCUI.mjs"),_context_AuthContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/context/AuthContext.js");const planOrder=["free","proA","proB","enterprise"];function useFeatureGuard(minPlan){const navigate=(0,react_router_dom__WEBPACK_IMPORTED_MODULE_2__.Zp)(),{user}=(0,_context_AuthContext__WEBPACK_IMPORTED_MODULE_1__.As)(),userPlan=(null==user?void 0:user.plan)||"free";(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{planOrder.indexOf(userPlan)<planOrder.indexOf(minPlan)&&navigate("/upgrade",{replace:!0})}),[userPlan,minPlan,navigate])}},"./src/pages/ContentAgentPage.stories.jsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>ContentAgentPage_stories});var react=__webpack_require__("../node_modules/react/index.js"),Container=__webpack_require__("./node_modules/react-bootstrap/esm/Container.js"),Row=__webpack_require__("./node_modules/react-bootstrap/esm/Row.js"),Col=__webpack_require__("./node_modules/react-bootstrap/esm/Col.js"),Card=__webpack_require__("./node_modules/react-bootstrap/esm/Card.js"),Button=__webpack_require__("./node_modules/react-bootstrap/esm/Button.js"),Spinner=__webpack_require__("./node_modules/react-bootstrap/esm/Spinner.js"),Alert=__webpack_require__("./node_modules/react-bootstrap/esm/Alert.js"),ListGroup=__webpack_require__("./node_modules/react-bootstrap/esm/ListGroup.js"),chunk_AYJ5UCUI=__webpack_require__("./node_modules/react-router/dist/development/chunk-AYJ5UCUI.mjs"),Form=__webpack_require__("./node_modules/react-bootstrap/esm/Form.js"),Stack=__webpack_require__("./node_modules/react-bootstrap/esm/Stack.js"),FormCheck=__webpack_require__("./node_modules/react-bootstrap/esm/FormCheck.js"),axiosInstance=__webpack_require__("./src/api/axiosInstance.js"),dist=__webpack_require__("./node_modules/react-toastify/dist/index.mjs"),jsx_runtime=__webpack_require__("../node_modules/react/jsx-runtime.js");function ContentGenerator(_ref){let{initialPrompt=""}=_ref;const[topic,setTopic]=(0,react.useState)(initialPrompt),[generatedText,setGeneratedText]=(0,react.useState)(""),[isGenerating,setIsGenerating]=(0,react.useState)(!1),[generationError,setGenerationError]=(0,react.useState)(null),[connectedPlatforms,setConnectedPlatforms]=(0,react.useState)({}),[selectedPlatformsForPosting,setSelectedPlatformsForPosting]=(0,react.useState)([]),[isPosting,setIsPosting]=(0,react.useState)(!1),[postingError,setPostingError]=(0,react.useState)(null),[postingResults,setPostingResults]=(0,react.useState)([]),[fetchingPlatforms,setFetchingPlatforms]=(0,react.useState)(!0);(0,react.useEffect)((()=>{(async()=>{setFetchingPlatforms(!0);try{const response=await axiosInstance.A.get("/api/platforms/status"),{_isMockData,...platforms}=response.data||{};setConnectedPlatforms(platforms||{})}catch(err){console.error("Error fetching platform statuses:",err),dist.oR.error("Could not load connected platforms.")}finally{setFetchingPlatforms(!1)}})()}),[]),(0,react.useEffect)((()=>{if(initialPrompt&&initialPrompt!==topic){const match=initialPrompt.match(/Generate content about: (.*)/i);setTopic(match?match[1]:initialPrompt),setGeneratedText(""),setPostingError(null),setPostingResults([]),setSelectedPlatformsForPosting([])}}),[initialPrompt,topic]);const handlePlatformSelect=e=>{const{value,checked}=e.target;setSelectedPlatformsForPosting((prev=>checked?[...prev,value]:prev.filter((p=>p!==value))))},platformsForPosting=Object.entries(connectedPlatforms).filter((_ref2=>{let[key,isConnected]=_ref2;return isConnected})).map((_ref3=>{let[key]=_ref3;return key}));return(0,jsx_runtime.jsxs)(Card.A,{className:"mt-4",id:"content-generator-card",children:[(0,jsx_runtime.jsx)(Card.A.Header,{as:"h5",children:"AI Content Generator"}),(0,jsx_runtime.jsxs)(Card.A.Body,{children:[(0,jsx_runtime.jsxs)(Form.A,{children:[(0,jsx_runtime.jsxs)(Form.A.Group,{className:"mb-3",controlId:"contentTopic",children:[(0,jsx_runtime.jsxs)(Form.A.Label,{children:["Topic / Main Idea ",initialPrompt?"(Based on Suggestion)":""]}),(0,jsx_runtime.jsx)(Form.A.Control,{as:"textarea",rows:4,placeholder:"Enter the main topic, keywords, or idea for the AI content generation...",value:topic,onChange:e=>setTopic(e.target.value),disabled:isGenerating||isPosting,required:!0}),(0,jsx_runtime.jsx)(Form.A.Text,{className:"text-muted",children:"The AI will use this topic along with your saved Brand Configuration settings (tone, target platforms, etc.)."})]}),(0,jsx_runtime.jsx)(Button.A,{variant:"primary",onClick:async()=>{if(!topic.trim())return setGenerationError("Please enter a topic or main idea."),void dist.oR.error("Please enter a topic or main idea.");setIsGenerating(!0),setGenerationError(null),setGeneratedText(""),setPostingError(null),setPostingResults([]),setSelectedPlatformsForPosting([]);try{console.log("Sending content generation request:",{topic});const response=await axiosInstance.A.post("/api/content/generate",{topic});console.log("Received response from backend:",response),response.data&&response.data.generatedContent?(setGeneratedText(response.data.generatedContent),dist.oR.success("Content generated successfully!")):(setGenerationError("Received an unexpected response format from the server."),console.warn("Unexpected backend response format:",response.data),dist.oR.error("Content generation failed: Unexpected response."))}catch(err){console.error("Error generating content:",err);let errorMessage="Failed to generate content.";err.response&&err.response.data&&err.response.data.message?errorMessage=err.response.data.message:err.message&&(errorMessage=err.message),setGenerationError(errorMessage),dist.oR.error(errorMessage)}finally{setIsGenerating(!1)}},disabled:isGenerating||isPosting||!topic.trim(),className:"mb-3 me-2",children:isGenerating?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Spinner.A,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),(0,jsx_runtime.jsx)("span",{className:"ms-2",children:"Generating..."})]}):"Generate Content"})]}),generationError&&(0,jsx_runtime.jsx)(Alert.A,{variant:"danger",className:"mt-3",children:generationError}),generatedText&&(0,jsx_runtime.jsx)(Card.A,{className:"mt-3 bg-light",children:(0,jsx_runtime.jsxs)(Card.A.Body,{children:[(0,jsx_runtime.jsx)(Card.A.Title,{children:"Generated Content:"}),(0,jsx_runtime.jsx)(Form.A.Control,{as:"textarea",rows:10,value:generatedText,onChange:e=>setGeneratedText(e.target.value),style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}}),(0,jsx_runtime.jsx)(Form.A.Text,{className:"text-muted",children:"You can edit the generated content before posting."}),(0,jsx_runtime.jsx)("hr",{}),(0,jsx_runtime.jsx)("h5",{className:"mt-3",children:"Post to Platforms"}),fetchingPlatforms?(0,jsx_runtime.jsx)(Spinner.A,{animation:"border",size:"sm"}):platformsForPosting.length>0?(0,jsx_runtime.jsxs)(Form.A.Group,{className:"mb-3",children:[(0,jsx_runtime.jsx)(Form.A.Label,{children:"Select platforms:"}),(0,jsx_runtime.jsx)(Stack.A,{direction:"horizontal",gap:3,className:"flex-wrap",children:platformsForPosting.map((platformKey=>(0,jsx_runtime.jsx)(FormCheck.A,{type:"checkbox",id:`post-platform-${platformKey}`,label:platformKey.charAt(0).toUpperCase()+platformKey.slice(1),value:platformKey,checked:selectedPlatformsForPosting.includes(platformKey),onChange:handlePlatformSelect,disabled:isPosting||isGenerating},platformKey)))})]}):(0,jsx_runtime.jsx)(Alert.A,{variant:"info",children:"No connected platforms available for posting. Connect platforms in Platform API Management."}),(0,jsx_runtime.jsx)(Button.A,{variant:"success",onClick:async()=>{if(!generatedText||0===selectedPlatformsForPosting.length)return setPostingError("Please generate content and select at least one platform to post."),void dist.oR.error("Please generate content and select at least one platform.");setIsPosting(!0),setPostingError(null),setPostingResults([]);try{var _response$data$messag;console.log(`Posting content to: ${selectedPlatformsForPosting.join(", ")}`);const response=await axiosInstance.A.post("/api/content/post",{message:generatedText,platforms:selectedPlatformsForPosting});console.log("Posting response:",response.data),setPostingResults(response.data.results||[]),207===response.status||null!==(_response$data$messag=response.data.message)&&void 0!==_response$data$messag&&_response$data$messag.includes("error")?(dist.oR.warn(response.data.message||"Posting completed with some errors."),setPostingError("Some platforms failed to post. Check results below.")):dist.oR.success(response.data.message||"Content posted successfully!")}catch(err){var _err$response,_err$response$data,_err$response2,_err$response2$data;console.error("Error posting content:",err);const message=(null===(_err$response=err.response)||void 0===_err$response||null===(_err$response$data=_err$response.data)||void 0===_err$response$data?void 0:_err$response$data.message)||"Failed to post content.";setPostingError(message),dist.oR.error(message),null!==(_err$response2=err.response)&&void 0!==_err$response2&&null!==(_err$response2$data=_err$response2.data)&&void 0!==_err$response2$data&&_err$response2$data.results&&setPostingResults(err.response.data.results)}finally{setIsPosting(!1)}},disabled:isPosting||isGenerating||0===selectedPlatformsForPosting.length||0===platformsForPosting.length,children:isPosting?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Spinner.A,{as:"span",animation:"border",size:"sm"}),(0,jsx_runtime.jsx)("span",{className:"ms-2",children:"Posting..."})]}):`Post to ${selectedPlatformsForPosting.length} Platform(s)`}),postingError&&(0,jsx_runtime.jsx)(Alert.A,{variant:"danger",className:"mt-3",children:postingError}),postingResults.length>0&&(0,jsx_runtime.jsxs)("div",{className:"mt-3",children:[(0,jsx_runtime.jsx)("h6",{children:"Posting Results:"}),(0,jsx_runtime.jsx)(ListGroup.A,{variant:"flush",children:postingResults.map(((result,index)=>(0,jsx_runtime.jsxs)(ListGroup.A.Item,{variant:result.success?"success":"danger",children:[(0,jsx_runtime.jsxs)("strong",{children:[result.platform.charAt(0).toUpperCase()+result.platform.slice(1),":"]}),result.success?`Success (Post ID: ${result.postId||"N/A"})`:`Failed - ${result.error}`]},index)))})]})]})})]})]})}const content_ContentGenerator=ContentGenerator;ContentGenerator.__docgenInfo={description:"",methods:[],displayName:"ContentGenerator",props:{initialPrompt:{defaultValue:{value:"''",computed:!1},required:!1}}};var useFeatureGuard=__webpack_require__("./src/hooks/useFeatureGuard.js");function ContentAgentPage(){(0,useFeatureGuard.B)("proA");const[suggestedIdeas,setSuggestedIdeas]=(0,react.useState)([]),[isLoadingIdeas,setIsLoadingIdeas]=(0,react.useState)(!1),[ideasError,setIdeasError]=(0,react.useState)(null),[selectedIdeaPrompt,setSelectedIdeaPrompt]=(0,react.useState)(""),fetchIdeas=async()=>{setIsLoadingIdeas(!0),setIdeasError(null),setSelectedIdeaPrompt("");try{console.log("Fetching content ideas...");const response=await axiosInstance.A.post("/api/content/suggest-ideas",{});console.log("Content ideas response:",response.data);const ideasArray=Array.isArray(response.data.suggestions)?response.data.suggestions:"string"==typeof response.data.suggestions&&""!==response.data.suggestions.trim()?[response.data.suggestions]:[];setSuggestedIdeas(ideasArray),0===ideasArray.length&&dist.oR.info("No content ideas were suggested. Try defining your Brand Profile!")}catch(err){var _err$response,_err$response$data;console.error("Error fetching content ideas:",err);const message=(null===(_err$response=err.response)||void 0===_err$response||null===(_err$response$data=_err$response.data)||void 0===_err$response$data?void 0:_err$response$data.message)||"Failed to fetch content ideas.";setIdeasError(message),dist.oR.error(message),setSuggestedIdeas([])}finally{setIsLoadingIdeas(!1)}};(0,react.useEffect)((()=>{fetchIdeas()}),[]);return(0,jsx_runtime.jsxs)(Container.A,{fluid:!0,className:"mt-4",children:[(0,jsx_runtime.jsx)("h2",{className:"mb-4",children:"Content Creation Agent"}),(0,jsx_runtime.jsxs)(Row.A,{children:[(0,jsx_runtime.jsx)(Col.A,{md:12,lg:4,className:"mb-4 mb-lg-0",children:(0,jsx_runtime.jsxs)(Card.A,{children:[(0,jsx_runtime.jsx)(Card.A.Header,{as:"h5",children:"Content Idea Suggestions"}),(0,jsx_runtime.jsxs)(Card.A.Body,{children:[(0,jsx_runtime.jsx)(Button.A,{variant:"outline-primary",onClick:fetchIdeas,disabled:isLoadingIdeas,className:"mb-3 w-100",children:isLoadingIdeas?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Spinner.A,{as:"span",animation:"border",size:"sm"}),(0,jsx_runtime.jsx)("span",{className:"ms-2",children:"Fetching Ideas..."})]}):"Get New Suggestions"}),(0,jsx_runtime.jsx)("div",{className:"d-grid gap-2 mb-3",children:(0,jsx_runtime.jsx)(chunk_AYJ5UCUI.N_,{to:"/brand-settings",className:"btn btn-outline-secondary btn-sm",children:"Configure Brand Profile"})}),ideasError&&(0,jsx_runtime.jsx)(Alert.A,{variant:"danger",children:ideasError}),!isLoadingIdeas&&!ideasError&&0===suggestedIdeas.length&&(0,jsx_runtime.jsxs)(Alert.A,{variant:"light",children:['Click "Get New Suggestions" or configure your ',(0,jsx_runtime.jsx)(chunk_AYJ5UCUI.N_,{to:"/brand-settings",children:"Brand Profile"})," for tailored ideas."]}),suggestedIdeas.length>0&&(0,jsx_runtime.jsx)(ListGroup.A,{variant:"flush",children:suggestedIdeas.map(((idea,index)=>{const ideaTopic="object"==typeof idea&&null!==idea?idea.topic:idea,ideaDescription="object"==typeof idea&&null!==idea?idea.description:"Click to generate content based on this topic.";return"string"!=typeof ideaTopic||""===ideaTopic.trim()?(console.warn("Skipping invalid idea item:",idea),null):(0,jsx_runtime.jsx)(ListGroup.A.Item,{action:!0,onClick:()=>(idea=>{const ideaText="object"==typeof idea&&null!==idea?idea.topic:idea;setSelectedIdeaPrompt(`Generate content about: ${ideaText}`)})(idea),className:"d-flex justify-content-between align-items-start",children:(0,jsx_runtime.jsxs)("div",{className:"ms-2 me-auto",children:[(0,jsx_runtime.jsx)("div",{className:"fw-bold",children:ideaTopic}),ideaDescription]})},index)}))})]})]})}),(0,jsx_runtime.jsx)(Col.A,{md:12,lg:8,children:(0,jsx_runtime.jsx)(content_ContentGenerator,{initialPrompt:selectedIdeaPrompt},selectedIdeaPrompt)})]})]})}const pages_ContentAgentPage=ContentAgentPage;ContentAgentPage.__docgenInfo={description:"",methods:[],displayName:"ContentAgentPage"};var AuthContext=__webpack_require__("./src/context/AuthContext.js");const ContentAgentPage_stories={title:"Pages/Content Agent Page",tags:["backend"],component:pages_ContentAgentPage,decorators:[Story=>(0,jsx_runtime.jsx)(AuthContext.cy.Provider,{value:{user:{plan:"enterprise"}},children:(0,jsx_runtime.jsx)(chunk_AYJ5UCUI.fS,{initialEntries:["/data/content-generator"],children:(0,jsx_runtime.jsx)(Story,{})})})]},Default=(args=>(0,jsx_runtime.jsx)(pages_ContentAgentPage,{})).bind({});Default.args={};const __namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => <ContentAgentPage />",...Default.parameters?.docs?.source}}}}}]);